<!DOCTYPE html>
<html class="writer-html5" lang="es" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Clase 12: Introducción al paquete Scipy &mdash; documentación de Clases de Python - </title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/rtd_overrides.css" type="text/css" />
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
        <script src="_static/translations.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="search" title="Búsqueda" href="search.html" />
    <link rel="next" title="Ejercicios" href="ejercicios.html" />
    <link rel="prev" title="Clase 11: Graficación usando Plotly" href="clase_11.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> Clases de Python
            <img src="_static/logo.svg" class="logo" alt="Logotipo"/>
          </a>
              <div class="version">
                IB - 2024
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Buscar documentos" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Dictado de las clases</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="clase_00.html">Clase 0: Introducción al lenguaje Python orientado a Ingenierías y Física</a></li>
<li class="toctree-l1"><a class="reference internal" href="clase_01.html">Clase 1: Introducción al lenguaje</a></li>
<li class="toctree-l1"><a class="reference internal" href="clase_02.html">Clase 2: Modularización y tipos compuestos</a></li>
<li class="toctree-l1"><a class="reference internal" href="clase_03.html">Clase 3: Tipos complejos y control de flujo</a></li>
<li class="toctree-l1"><a class="reference internal" href="clase_04.html">Clase 4: Iteraciones y detalles de Funciones</a></li>
<li class="toctree-l1"><a class="reference internal" href="clase_05.html">Clase 5: Persistencia de datos y administración de problemas</a></li>
<li class="toctree-l1"><a class="reference internal" href="clase_06.html">Clase 6: Programación Orientada a Objetos</a></li>
<li class="toctree-l1"><a class="reference internal" href="clase_07.html">Clase 7: Funciones, decoradores y programación funcional</a></li>
<li class="toctree-l1"><a class="reference internal" href="clase_08.html">Clase 8: Introducción a Numpy</a></li>
<li class="toctree-l1"><a class="reference internal" href="clase_09.html">Clase 9: Visualización</a></li>
<li class="toctree-l1"><a class="reference internal" href="clase_10.html">Clase 10: Más información sobre <strong>Numpy</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="clase_11.html">Clase 11: Graficación usando Plotly</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Clase 12: Introducción al paquete Scipy</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#una-mirada-rapida-a-scipy">Una mirada rápida a Scipy</a></li>
<li class="toctree-l2"><a class="reference internal" href="#funciones-especiales">Funciones especiales</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#funciones-de-bessel">Funciones de Bessel</a></li>
<li class="toctree-l3"><a class="reference internal" href="#funcion-error">Función Error</a></li>
<li class="toctree-l3"><a class="reference internal" href="#evaluacion-de-polinomios-ortogonales">Evaluación de polinomios ortogonales</a></li>
<li class="toctree-l3"><a class="reference internal" href="#factorial-permutaciones-y-combinaciones">Factorial, permutaciones y combinaciones</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#integracion-numerica">Integración numérica</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#ejemplo-de-funcion-fuertemente-oscilatoria">Ejemplo de función fuertemente oscilatoria</a></li>
<li class="toctree-l3"><a class="reference internal" href="#funciones-de-mas-de-una-variable">Funciones de más de una variable</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#ejercicios-12-a">Ejercicios 12 (a)</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Ejercicios de Clase</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="ejercicios.html">Ejercicios</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="entregas_ejercicios.html">Entrega de ejercicios</a></li>
<li class="toctree-l1"><a class="reference internal" href="programa_detalle.html">Programa Detallado</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Clases de Python</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a></li>
      <li class="breadcrumb-item active">Clase 12: Introducción al paquete Scipy</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/clase_12.rst.txt" rel="nofollow"> Ver código fuente de la página</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="clase-12-introduccion-al-paquete-scipy">
<span id="clase-12"></span><h1>Clase 12: Introducción al paquete Scipy<a class="headerlink" href="#clase-12-introduccion-al-paquete-scipy" title="Enlace permanente a este encabezado"></a></h1>
<p>El paquete <strong>Scipy</strong> es una colección de algoritmos y funciones
construida sobre <strong>Numpy</strong> para facilitar cálculos y actividades
relacionadas con el trabajo técnico/científico.</p>
<section id="una-mirada-rapida-a-scipy">
<h2>Una mirada rápida a Scipy<a class="headerlink" href="#una-mirada-rapida-a-scipy" title="Enlace permanente a este encabezado"></a></h2>
<p>La ayuda de scipy contiene (con <code class="docutils literal notranslate"><span class="pre">help(scipy)</span></code> entre otras cosas)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Contents
--------
SciPy imports all the functions from the NumPy namespace, and in
addition provides:

Subpackages
-----------
Using any of these subpackages requires an explicit import.  For example,
``import scipy.cluster``.

::

 cluster                      --- Vector Quantization / Kmeans
 fftpack                      --- Discrete Fourier Transform algorithms
 integrate                    --- Integration routines
 interpolate                  --- Interpolation Tools
 io                           --- Data input and output
 linalg                       --- Linear algebra routines
 linalg.blas                  --- Wrappers to BLAS library
 linalg.lapack                --- Wrappers to LAPACK library
 misc                         --- Various utilities that don&#39;t have
                                  another home.
 ndimage                      --- n-dimensional image package
 odr                          --- Orthogonal Distance Regression
 optimize                     --- Optimization Tools
 signal                       --- Signal Processing Tools
 sparse                       --- Sparse Matrices
 sparse.linalg                --- Sparse Linear Algebra
 sparse.linalg.dsolve         --- Linear Solvers
 sparse.linalg.dsolve.umfpack --- :Interface to the UMFPACK library:
                                  Conjugate Gradient Method (LOBPCG)
 sparse.linalg.eigen          --- Sparse Eigenvalue Solvers
 sparse.linalg.eigen.lobpcg   --- Locally Optimal Block Preconditioned
                                  Conjugate Gradient Method (LOBPCG)
 spatial                      --- Spatial data structures and algorithms
 special                      --- Special functions
 stats                        --- Statistical Functions
</pre></div>
</div>
<p>Más información puede encontrarse en la <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference">documentación oficial de
Scipy</a></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</section>
<section id="funciones-especiales">
<h2>Funciones especiales<a class="headerlink" href="#funciones-especiales" title="Enlace permanente a este encabezado"></a></h2>
<p>En el submódulo <code class="docutils literal notranslate"><span class="pre">scipy.special</span></code> están definidas un número de funciones
especiales. Una lista general de las funciones definidas (De cada tipo
hay varias funciones) es:</p>
<ul class="simple">
<li><p>Airy functions</p></li>
<li><p>Elliptic Functions and Integrals</p></li>
<li><p>Bessel Functions</p></li>
<li><p>Struve Functions</p></li>
<li><p>Raw Statistical Functions</p></li>
<li><p>Information Theory Functions</p></li>
<li><p>Gamma and Related Functions</p></li>
<li><p>Error Function and Fresnel Integrals</p></li>
<li><p>Legendre Functions</p></li>
<li><p>Ellipsoidal Harmonics</p></li>
<li><p>Orthogonal polynomials</p></li>
<li><p>Hypergeometric Functions</p></li>
<li><p>Parabolic Cylinder Functions</p></li>
<li><p>Mathieu and Related Functions</p></li>
<li><p>Spheroidal Wave Functions</p></li>
<li><p>Kelvin Functions</p></li>
<li><p>Combinatorics</p></li>
<li><p>Other Special Functions</p></li>
<li><p>Convenience Functions</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">special</span>
</pre></div>
</div>
<section id="funciones-de-bessel">
<h3>Funciones de Bessel<a class="headerlink" href="#funciones-de-bessel" title="Enlace permanente a este encabezado"></a></h3>
<p>Las funciones de Bessel son soluciones de la ecuación diferencial:</p>
<div class="math notranslate nohighlight">
\[x^2 \frac{d^2 y}{dx^2} + x \frac{dy}{dx} + (x^2 - \nu^2)y = 0 .\]</div>
<p>Para valores enteros de <span class="math notranslate nohighlight">\(\nu\)</span> se trata de una familia de funciones
que aparecen como soluciones de problemas de propagación de ondas en
problemas con simetría cilíndrica.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">special</span><span class="o">.</span><span class="n">jv</span><span class="p">)</span>
</pre></div>
</div>
<pre class="literal-block">jv(x1, x2, /, out=None, <a href="#id1"><span class="problematic" id="id2">*</span></a>, where=True, casting='same_kind', order='K', dtype=None, subok=True[, signature, extobj])

jv(v, z, out=None)

Bessel function of the first kind of real order and complex argument.

Parameters
----------
v : array_like
    Order (float).
z : array_like
    Argument (float or complex).
out : ndarray, optional
    Optional output array for the function values

Returns
-------
J : scalar or ndarray
    Value of the Bessel function, <span class="math notranslate nohighlight">\(J_v(z)\)</span>.

See also
--------
jve : <span class="math notranslate nohighlight">\(J_v\)</span> with leading exponential behavior stripped off.
spherical_jn : spherical Bessel functions.
j0 : faster version of this function for order 0.
j1 : faster version of this function for order 1.

Notes
-----
For positive <cite>v</cite> values, the computation is carried out using the AMOS
<a href="#id6"><span class="problematic" id="id3">[1]_</span></a> <cite>zbesj</cite> routine, which exploits the connection to the modified
Bessel function <span class="math notranslate nohighlight">\(I_v\)</span>,

.. math::
    J_v(z) = exp(vpiimath/2) I_v(-imath z)qquad (Im z &gt; 0)

    J_v(z) = exp(-vpiimath/2) I_v(imath z)qquad (Im z &lt; 0)

For negative <cite>v</cite> values the formula,

.. math:: J_{-v}(z) = J_v(z) cos(pi v) - Y_v(z) sin(pi v)

is used, where <span class="math notranslate nohighlight">\(Y_v(z)\)</span> is the Bessel function of the second
kind, computed using the AMOS routine <cite>zbesy</cite>.  Note that the second
term is exactly zero for integer <cite>v</cite>; to improve accuracy the second
term is explicitly omitted for <cite>v</cite> values such that <cite>v = floor(v)</cite>.

Not to be confused with the spherical Bessel functions (see <cite>spherical_jn</cite>).

References
----------
.. [1] Donald E. Amos, &quot;AMOS, A Portable Package for Bessel Functions
       of a Complex Argument and Nonnegative Order&quot;,
       <a class="reference external" href="http://netlib.org/amos/">http://netlib.org/amos/</a>

Examples
--------
Evaluate the function of order 0 at one point.

&gt;&gt;&gt; from scipy.special import jv
&gt;&gt;&gt; jv(0, 1.)
0.7651976865579666

Evaluate the function at one point for different orders.

&gt;&gt;&gt; jv(0, 1.), jv(1, 1.), jv(1.5, 1.)
(0.7651976865579666, 0.44005058574493355, 0.24029783912342725)

The evaluation for different orders can be carried out in one call by
providing a list or NumPy array as argument for the <cite>v</cite> parameter:

&gt;&gt;&gt; jv([0, 1, 1.5], 1.)
array([0.76519769, 0.44005059, 0.24029784])

Evaluate the function at several points for order 0 by providing an
array for <cite>z</cite>.

&gt;&gt;&gt; import numpy as np
&gt;&gt;&gt; points = np.array([-2., 0., 3.])
&gt;&gt;&gt; jv(0, points)
array([ 0.22389078,  1.        , -0.26005195])

If <cite>z</cite> is an array, the order parameter <cite>v</cite> must be broadcastable to
the correct shape if different orders shall be computed in one call.
To calculate the orders 0 and 1 for an 1D array:

&gt;&gt;&gt; orders = np.array([[0], [1]])
&gt;&gt;&gt; orders.shape
(2, 1)

&gt;&gt;&gt; jv(orders, points)
array([[ 0.22389078,  1.        , -0.26005195],
       [-0.57672481,  0.        ,  0.33905896]])

Plot the functions of order 0 to 3 from -10 to 10.

&gt;&gt;&gt; import matplotlib.pyplot as plt
&gt;&gt;&gt; fig, ax = plt.subplots()
&gt;&gt;&gt; x = np.linspace(-10., 10., 1000)
&gt;&gt;&gt; for i in range(4):
...     ax.plot(x, jv(i, x), label=f'$J_{i!r}$')
&gt;&gt;&gt; ax.legend()
&gt;&gt;&gt; plt.show()</pre>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">special</span><span class="o">.</span><span class="n">jn_zeros</span><span class="p">)</span>
</pre></div>
</div>
<pre class="literal-block"> jn_zeros(n, nt)

Compute zeros of integer-order Bessel functions Jn.

Compute <cite>nt</cite> zeros of the Bessel functions <span class="math notranslate nohighlight">\(J_n(x)\)</span> on the
interval <span class="math notranslate nohighlight">\((0, \infty)\)</span>. The zeros are returned in ascending
order. Note that this interval excludes the zero at <span class="math notranslate nohighlight">\(x = 0\)</span>
that exists for <span class="math notranslate nohighlight">\(n &gt; 0\)</span>.

Parameters
----------
n : int
    Order of Bessel function
nt : int
    Number of zeros to return

Returns
-------
ndarray
    First <cite>nt</cite> zeros of the Bessel function.

See Also
--------
jv: Real-order Bessel functions of the first kind
jnp_zeros: Zeros of <span class="math notranslate nohighlight">\(Jn'\)</span>

References
----------
.. [1] Zhang, Shanjie and Jin, Jianming. &quot;Computation of Special
       Functions&quot;, John Wiley and Sons, 1996, chapter 5.
       <a class="reference external" href="https://people.sc.fsu.edu/~jburkardt/f77_src/special_functions/special_functions.html">https://people.sc.fsu.edu/~jburkardt/f77_src/special_functions/special_functions.html</a>

Examples
--------
Compute the first four positive roots of <span class="math notranslate nohighlight">\(J_3\)</span>.

&gt;&gt;&gt; from scipy.special import jn_zeros
&gt;&gt;&gt; jn_zeros(3, 4)
array([ 6.3801619 ,  9.76102313, 13.01520072, 16.22346616])

Plot <span class="math notranslate nohighlight">\(J_3\)</span> and its first four positive roots. Note
that the root located at 0 is not returned by <cite>jn_zeros</cite>.

&gt;&gt;&gt; import numpy as np
&gt;&gt;&gt; import matplotlib.pyplot as plt
&gt;&gt;&gt; from scipy.special import jn, jn_zeros
&gt;&gt;&gt; j3_roots = jn_zeros(3, 4)
&gt;&gt;&gt; xmax = 18
&gt;&gt;&gt; xmin = -1
&gt;&gt;&gt; x = np.linspace(xmin, xmax, 500)
&gt;&gt;&gt; fig, ax = plt.subplots()
&gt;&gt;&gt; ax.plot(x, jn(3, x), label=r'$J_3$')
&gt;&gt;&gt; ax.scatter(j3_roots, np.zeros((4, )), s=30, c='r',
...            label=r&quot;$J_3$_Zeros&quot;, zorder=5)
&gt;&gt;&gt; ax.scatter(0, 0, s=30, c='k',
...            label=r&quot;Root at 0&quot;, zorder=5)
&gt;&gt;&gt; ax.hlines(0, 0, xmax, color='k')
&gt;&gt;&gt; ax.set_xlim(xmin, xmax)
&gt;&gt;&gt; plt.legend()
&gt;&gt;&gt; plt.show()</pre>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Ceros de la función de Bessel</span>
<span class="c1"># Los tres primeros valores de x en los cuales se anula la función de Bessel de orden 4.</span>
<span class="n">special</span><span class="o">.</span><span class="n">jn_zeros</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span> <span class="mf">7.58834243</span><span class="p">,</span> <span class="mf">11.06470949</span><span class="p">,</span> <span class="mf">14.37253667</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">2</span><span class="p">):</span>
  <span class="n">p</span><span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">special</span><span class="o">.</span><span class="n">jn</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">x</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$J_</span><span class="si">{}</span><span class="s1">(x)$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
  <span class="n">z</span> <span class="o">=</span> <span class="n">special</span><span class="o">.</span><span class="n">jn_zeros</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
  <span class="n">z</span> <span class="o">=</span> <span class="n">z</span><span class="p">[</span><span class="n">z</span> <span class="o">&lt;</span> <span class="mi">15</span><span class="p">]</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">z</span><span class="o">.</span><span class="n">size</span><span class="p">),</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_color</span><span class="p">())</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Funciones $J_n$ de Bessel&#39;</span><span class="p">,</span> <span class="n">ncol</span><span class="o">=</span><span class="mi">2</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/12_1_intro_scipy_10_0.png" src="_images/12_1_intro_scipy_10_0.png" />
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># jn es otro nombre para jv</span>
<span class="nb">print</span><span class="p">(</span><span class="n">special</span><span class="o">.</span><span class="n">jn</span> <span class="o">==</span> <span class="n">special</span><span class="o">.</span><span class="n">jv</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">special</span><span class="o">.</span><span class="n">jn</span> <span class="ow">is</span> <span class="n">special</span><span class="o">.</span><span class="n">jv</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kc">True</span>
<span class="kc">True</span>
</pre></div>
</div>
<p>Como vemos, hay funciones para calcular funciones de Bessel. Aquí
mostramos los órdenes enteros pero también se pueden utilizar órdenes
<span class="math notranslate nohighlight">\(\nu\)</span> reales. La lista de funciones de Bessel (puede obtenerse de
la ayuda sobre <code class="docutils literal notranslate"><span class="pre">scipy.special</span></code>) es:</p>
<ul class="simple">
<li><p>Bessel Functions</p></li>
<li><p>Zeros of Bessel Functions</p></li>
<li><p>Faster versions of common Bessel Functions</p></li>
<li><p>Integrals of Bessel Functions</p></li>
<li><p>Derivatives of Bessel Functions</p></li>
<li><p>Spherical Bessel Functions</p></li>
<li><p>Riccati-Bessel Functions</p></li>
</ul>
<p>Por ejemplo, podemos calcular las funciones esféricas de Bessel, que
aparecen en problemas con simetría esférica:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">2</span><span class="p">):</span>
  <span class="n">p</span><span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">special</span><span class="o">.</span><span class="n">spherical_jn</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">x</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$j_</span><span class="si">{}</span><span class="s1">(x)$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Funciones esféricas de Bessel $j_n$&#39;</span><span class="p">,</span> <span class="n">ncol</span><span class="o">=</span><span class="mi">2</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/12_1_intro_scipy_13_0.png" src="_images/12_1_intro_scipy_13_0.png" />
</section>
<section id="funcion-error">
<h3>Función Error<a class="headerlink" href="#funcion-error" title="Enlace permanente a este encabezado"></a></h3>
<p>La función error es el resultado de integrar una función Gaussiana</p>
<div class="math notranslate nohighlight">
\[\operatorname{erf}z=\frac{2}{\sqrt{\pi}}\int_{0}^{z}e^{-t^{2}}\mathrm{d}t,\]</div>
<p>mientras que las integrales seno y coseno de Fresnel están definidas
por:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\operatorname{ssa}= \int_{0}^{z} \sin(\pi/2  t^2) \mathrm{d} t \\
\operatorname{csa}= \int_{0}^{z} \cos(\pi/2  t^2) \mathrm{d} t\end{split}\]</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">special</span><span class="o">.</span><span class="n">fresnel</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">special</span><span class="o">.</span><span class="n">erf</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\mathrm</span><span class="si">{erf}</span><span class="s1">(x)$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\mathrm</span><span class="si">{ssa}</span><span class="s1">(x)$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\mathrm</span><span class="si">{csa}</span><span class="s1">(x)$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$x$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$f(x)$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/12_1_intro_scipy_15_0.png" src="_images/12_1_intro_scipy_15_0.png" />
</section>
<section id="evaluacion-de-polinomios-ortogonales">
<h3>Evaluación de polinomios ortogonales<a class="headerlink" href="#evaluacion-de-polinomios-ortogonales" title="Enlace permanente a este encabezado"></a></h3>
<p><code class="docutils literal notranslate"><span class="pre">Scipy.special</span></code> tiene funciones para evaluar eficientemente polinomios
ortogonales</p>
<p>Por ejemplo si queremos, evaluar los polinomios de Laguerre, solución de
la ecuación diferencial:</p>
<div class="math notranslate nohighlight">
\[x\frac{d^2}{dx^2}L_n + (1 - x)\frac{d}{dx}L_n + nL_n = 0\]</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>plt.legend?
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">):</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">special</span><span class="o">.</span><span class="n">eval_laguerre</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">x</span><span class="p">),</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$n=</span><span class="si">{}</span><span class="s1">$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$x$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$f(x)$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">,</span> <span class="n">ncol</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/12_1_intro_scipy_18_0.png" src="_images/12_1_intro_scipy_18_0.png" />
<p>Los polinomios de Chebyshev son solución de</p>
<div class="math notranslate nohighlight">
\[(1 - x^2)\frac{d^2}{dx^2}T_n - x\frac{d}{dx}T_n + n^2T_n = 0\]</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">):</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">special</span><span class="o">.</span><span class="n">eval_chebyt</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">x</span><span class="p">),</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;$n=</span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s1">$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$x$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$f(x)$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">,</span> <span class="n">ncol</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">((</span><span class="o">-</span><span class="mf">1.1</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/12_1_intro_scipy_20_0.png" src="_images/12_1_intro_scipy_20_0.png" />
</section>
<section id="factorial-permutaciones-y-combinaciones">
<h3>Factorial, permutaciones y combinaciones<a class="headerlink" href="#factorial-permutaciones-y-combinaciones" title="Enlace permanente a este encabezado"></a></h3>
<p>Hay funciones para calcular varias funciones relacionadas con
combinatoria</p>
<p>La función <code class="docutils literal notranslate"><span class="pre">comb()</span></code> da el número de maneras de elegir <code class="docutils literal notranslate"><span class="pre">k</span></code> de un
total de <code class="docutils literal notranslate"><span class="pre">N</span></code> elementos. Sin repeticiones está dada por:</p>
<div class="math notranslate nohighlight">
\[\frac{N!}{k! (N-k)!}\]</div>
<p>mientras que si cada elemento puede repetirse, la fórmula es:</p>
<div class="math notranslate nohighlight">
\[\frac{(N+k-1)!}{k! (N-1)!}\]</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">special</span><span class="o">.</span><span class="n">comb</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span> <span class="mf">45.</span><span class="p">,</span> <span class="mf">120.</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Si usamos exact=True, k no puede ser un array</span>
<span class="n">special</span><span class="o">.</span><span class="n">comb</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">exact</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">120</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">special</span><span class="o">.</span><span class="n">comb</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">k</span><span class="p">,</span> <span class="n">repetition</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span> <span class="mf">55.</span><span class="p">,</span> <span class="mf">220.</span><span class="p">])</span>
</pre></div>
</div>
<p>El número de permutaciones se obtiene con la función <code class="docutils literal notranslate"><span class="pre">perm()</span></code>, y está
dado por:</p>
<div class="math notranslate nohighlight">
\[\frac{N!}{(N-k)!}\]</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">special</span><span class="o">.</span><span class="n">perm</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">k</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span> <span class="mf">90.</span><span class="p">,</span> <span class="mf">720.</span><span class="p">])</span>
</pre></div>
</div>
<p>que corresponde a:</p>
<div class="math notranslate nohighlight">
\[\frac{10!}{(10-3)!} = 10 \cdot 9 \cdot 8\]</div>
<p>Los números factorial (N!) y doble factorial (N!!) son:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">8</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">N</span><span class="si">}</span><span class="s2">! = </span><span class="si">{</span><span class="n">special</span><span class="o">.</span><span class="n">factorial</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">N</span><span class="si">}</span><span class="s2">!! = </span><span class="si">{</span><span class="n">special</span><span class="o">.</span><span class="n">factorial2</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>[3 6 8]! = [6.000e+00 7.200e+02 4.032e+04]
[3 6 8]!! = [  3.  48. 384.]
</pre></div>
</div>
</section>
</section>
<section id="integracion-numerica">
<h2>Integración numérica<a class="headerlink" href="#integracion-numerica" title="Enlace permanente a este encabezado"></a></h2>
<p>Scipy tiene rutinas para integrar numéricamente funciones o tablas de
datos. Por ejemplo para integrar funciones en la forma:</p>
<div class="math notranslate nohighlight">
\[I= \int_{a}^{b} f(x)\, dx\]</div>
<p>la función más utilizada es <code class="docutils literal notranslate"><span class="pre">quad</span></code>, que llama a distintas rutinas del
paquete <strong>QUADPACK</strong> dependiendo de los argumentos que toma. Entre los
aspectos más notables está la posibilidad de elegir una función de peso
entre un conjunto definido de funciones, y la posibilidad de elegir un
dominio de integración finito o infinito.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">integrate</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">10.</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">f1</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
  <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">f1</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="o">&lt;</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">lines</span><span class="o">.</span><span class="n">Line2D</span> <span class="n">at</span> <span class="mh">0x7f774c2127d0</span><span class="o">&gt;</span><span class="p">]</span>
</pre></div>
</div>
<img alt="_images/12_1_intro_scipy_35_1.png" src="_images/12_1_intro_scipy_35_1.png" />
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">integrate</span><span class="o">.</span><span class="n">quad</span><span class="p">(</span><span class="n">f1</span><span class="p">,</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="o">-</span><span class="mf">0.3872712191192437</span><span class="p">,</span> <span class="mf">7.902359254702111e-13</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">integrate</span><span class="o">.</span><span class="n">quad</span><span class="p">)</span>
</pre></div>
</div>
<pre class="literal-block"> quad(func, a, b, args=(), full_output=0, epsabs=1.49e-08, epsrel=1.49e-08,
      limit=50, points=None, weight=None, wvar=None, wopts=None, maxp1=50,
      limlst=50, complex_func=False)

Compute a definite integral.

Integrate func from <cite>a</cite> to <cite>b</cite> (possibly infinite interval) using a
technique from the Fortran library QUADPACK.

Parameters
----------
func : {function, scipy.LowLevelCallable}
    A Python function or method to integrate. If <cite>func</cite> takes many
    arguments, it is integrated along the axis corresponding to the
    first argument.

    If the user desires improved integration performance, then <cite>f</cite> may
    be a <cite>scipy.LowLevelCallable</cite> with one of the signatures::

        double func(double x)
        double func(double x, void <em>user_data)
        double func(int n, double *xx)
        double func(int n, double *xx, void *user_data)

    The ``user_data`` is the data contained in the `scipy.LowLevelCallable`.
    In the call forms with ``xx``,  ``n`` is the length of the ``xx``
    array which contains ``xx[0] == x`` and the rest of the items are
    numbers contained in the ``args`` argument of quad.

    In addition, certain ctypes call signatures are supported for
    backward compatibility, but those should not be used in new code.
a : float
    Lower limit of integration (use -numpy.inf for -infinity).
b : float
    Upper limit of integration (use numpy.inf for +infinity).
args : tuple, optional
    Extra arguments to pass to `func`.
full_output : int, optional
    Non-zero to return a dictionary of integration information.
    If non-zero, warning messages are also suppressed and the
    message is appended to the output tuple.
complex_func : bool, optional
    Indicate if the function's (`func`) return type is real
    (``complex_func=False``: default) or complex (``complex_func=True``).
    In both cases, the function's argument is real.
    If full_output is also non-zero, the `infodict`, `message`, and
    `explain` for the real and complex components are returned in
    a dictionary with keys &quot;real output&quot; and &quot;imag output&quot;.

Returns
-------
y : float
    The integral of func from `a` to `b`.
abserr : float
    An estimate of the absolute error in the result.
infodict : dict
    A dictionary containing additional information.
message
    A convergence message.
explain
    Appended only with 'cos' or 'sin' weighting and infinite
    integration limits, it contains an explanation of the codes in
    infodict['ierlst']

Other Parameters
----------------
epsabs : float or int, optional
    Absolute error tolerance. Default is 1.49e-8. `quad` tries to obtain
    an accuracy of ``abs(i-result) &lt;= max(epsabs, epsrel*abs(i))``
    where ``i`` = integral of `func` from `a` to `b`, and ``result`` is the
    numerical approximation. See `epsrel` below.
epsrel : float or int, optional
    Relative error tolerance. Default is 1.49e-8.
    If ``epsabs &lt;= 0``, `epsrel` must be greater than both 5e-29
    and ``50 * (machine epsilon)``. See `epsabs` above.
limit : float or int, optional
    An upper bound on the number of subintervals used in the adaptive
    algorithm.
points : (sequence of floats,ints), optional
    A sequence of break points in the bounded integration interval
    where local difficulties of the integrand may occur (e.g.,
    singularities, discontinuities). The sequence does not have
    to be sorted. Note that this option cannot be used in conjunction
    with ``weight``.
weight : float or int, optional
    String indicating weighting function. Full explanation for this
    and the remaining arguments can be found below.
wvar : optional
    Variables for use with weighting functions.
wopts : optional
    Optional input for reusing Chebyshev moments.
maxp1 : float or int, optional
    An upper bound on the number of Chebyshev moments.
limlst : int, optional
    Upper bound on the number of cycles (&gt;=3) for use with a sinusoidal
    weighting and an infinite end-point.

See Also
--------
dblquad : double integral
tplquad : triple integral
nquad : n-dimensional integrals (uses `quad` recursively)
fixed_quad : fixed-order Gaussian quadrature
quadrature : adaptive Gaussian quadrature
odeint : ODE integrator
ode : ODE integrator
simpson : integrator for sampled data
romb : integrator for sampled data
scipy.special : for coefficients and roots of orthogonal polynomials

Notes
-----

**Extra information for quad() inputs and outputs*</em>

If full_output is non-zero, then the third output argument
(infodict) is a dictionary with entries as tabulated below. For
infinite limits, the range is transformed to (0,1) and the
optional outputs are given with respect to this transformed range.
Let M be the input argument limit and let K be infodict['last'].
The entries are:

'neval'
    The number of function evaluations.
'last'
    The number, K, of subintervals produced in the subdivision process.
'alist'
    A rank-1 array of length M, the first K elements of which are the
    left end points of the subintervals in the partition of the
    integration range.
'blist'
    A rank-1 array of length M, the first K elements of which are the
    right end points of the subintervals.
'rlist'
    A rank-1 array of length M, the first K elements of which are the
    integral approximations on the subintervals.
'elist'
    A rank-1 array of length M, the first K elements of which are the
    moduli of the absolute error estimates on the subintervals.
'iord'
    A rank-1 integer array of length M, the first L elements of
    which are pointers to the error estimates over the subintervals
    with <code class="docutils literal notranslate"><span class="pre">L=K</span></code> if <code class="docutils literal notranslate"><span class="pre">K&lt;=M/2+2</span></code> or <code class="docutils literal notranslate"><span class="pre">L=M+1-K</span></code> otherwise. Let I be the
    sequence <code class="docutils literal notranslate"><span class="pre">infodict['iord']</span></code> and let E be the sequence
    <code class="docutils literal notranslate"><span class="pre">infodict['elist']</span></code>.  Then <code class="docutils literal notranslate"><span class="pre">E[I[1]],</span> <span class="pre">...,</span> <span class="pre">E[I[L]]</span></code> forms a
    decreasing sequence.

If the input argument points is provided (i.e., it is not None),
the following additional outputs are placed in the output
dictionary. Assume the points sequence is of length P.

'pts'
    A rank-1 array of length P+2 containing the integration limits
    and the break points of the intervals in ascending order.
    This is an array giving the subintervals over which integration
    will occur.
'level'
    A rank-1 integer array of length M (=limit), containing the
    subdivision levels of the subintervals, i.e., if (aa,bb) is a
    subinterval of <code class="docutils literal notranslate"><span class="pre">(pts[1],</span> <span class="pre">pts[2])</span></code> where <code class="docutils literal notranslate"><span class="pre">pts[0]</span></code> and <code class="docutils literal notranslate"><span class="pre">pts[2]</span></code>
    are adjacent elements of <code class="docutils literal notranslate"><span class="pre">infodict['pts']</span></code>, then (aa,bb) has level l
    if <code class="docutils literal notranslate"><span class="pre">|bb-aa|</span> <span class="pre">=</span> <span class="pre">|pts[2]-pts[1]|</span> <span class="pre">*</span> <span class="pre">2**(-l)</span></code>.
'ndin'
    A rank-1 integer array of length P+2. After the first integration
    over the intervals (pts[1], pts[2]), the error estimates over some
    of the intervals may have been increased artificially in order to
    put their subdivision forward. This array has ones in slots
    corresponding to the subintervals for which this happens.

<strong>Weighting the integrand</strong>

The input variables, <em>weight</em> and <em>wvar</em>, are used to weight the
integrand by a select list of functions. Different integration
methods are used to compute the integral with these weighting
functions, and these do not support specifying break points. The
possible values of weight and the corresponding weighting functions are.

==========  ===================================   =====================
<code class="docutils literal notranslate"><span class="pre">weight</span></code>  Weight function used                  <code class="docutils literal notranslate"><span class="pre">wvar</span></code>
==========  ===================================   =====================
'cos'       cos(w*x)                              wvar = w
'sin'       sin(w*x)                              wvar = w
'alg'       g(x) = ((x-a)**alpha)*((b-x)**beta)   wvar = (alpha, beta)
'alg-loga'  g(x)*log(x-a)                         wvar = (alpha, beta)
'alg-logb'  g(x)*log(b-x)                         wvar = (alpha, beta)
'alg-log'   g(x)*log(x-a)*log(b-x)                wvar = (alpha, beta)
'cauchy'    1/(x-c)                               wvar = c
==========  ===================================   =====================

wvar holds the parameter w, (alpha, beta), or c depending on the weight
selected. In these expressions, a and b are the integration limits.

For the 'cos' and 'sin' weighting, additional inputs and outputs are
available.

For finite integration limits, the integration is performed using a
Clenshaw-Curtis method which uses Chebyshev moments. For repeated
calculations, these moments are saved in the output dictionary:

'momcom'
    The maximum level of Chebyshev moments that have been computed,
    i.e., if <code class="docutils literal notranslate"><span class="pre">M_c</span></code> is <code class="docutils literal notranslate"><span class="pre">infodict['momcom']</span></code> then the moments have been
    computed for intervals of length <code class="docutils literal notranslate"><span class="pre">|b-a|</span> <span class="pre">*</span> <span class="pre">2**(-l)</span></code>,
    <code class="docutils literal notranslate"><span class="pre">l=0,1,...,M_c</span></code>.
'nnlog'
    A rank-1 integer array of length M(=limit), containing the
    subdivision levels of the subintervals, i.e., an element of this
    array is equal to l if the corresponding subinterval is
    <code class="docutils literal notranslate"><span class="pre">|b-a|*</span> <span class="pre">2**(-l)</span></code>.
'chebmo'
    A rank-2 array of shape (25, maxp1) containing the computed
    Chebyshev moments. These can be passed on to an integration
    over the same interval by passing this array as the second
    element of the sequence wopts and passing infodict['momcom'] as
    the first element.

If one of the integration limits is infinite, then a Fourier integral is
computed (assuming w neq 0). If full_output is 1 and a numerical error
is encountered, besides the error message attached to the output tuple,
a dictionary is also appended to the output tuple which translates the
error codes in the array <code class="docutils literal notranslate"><span class="pre">info['ierlst']</span></code> to English messages. The
output information dictionary contains the following entries instead of
'last', 'alist', 'blist', 'rlist', and 'elist':

'lst'
    The number of subintervals needed for the integration (call it <code class="docutils literal notranslate"><span class="pre">K_f</span></code>).
'rslst'
    A rank-1 array of length M_f=limlst, whose first <code class="docutils literal notranslate"><span class="pre">K_f</span></code> elements
    contain the integral contribution over the interval
    <code class="docutils literal notranslate"><span class="pre">(a+(k-1)c,</span> <span class="pre">a+kc)</span></code> where <code class="docutils literal notranslate"><span class="pre">c</span> <span class="pre">=</span> <span class="pre">(2*floor(|w|)</span> <span class="pre">+</span> <span class="pre">1)</span> <span class="pre">*</span> <span class="pre">pi</span> <span class="pre">/</span> <span class="pre">|w|</span></code>
    and <code class="docutils literal notranslate"><span class="pre">k=1,2,...,K_f</span></code>.
'erlst'
    A rank-1 array of length <code class="docutils literal notranslate"><span class="pre">M_f</span></code> containing the error estimate
    corresponding to the interval in the same position in
    <code class="docutils literal notranslate"><span class="pre">infodict['rslist']</span></code>.
'ierlst'
    A rank-1 integer array of length <code class="docutils literal notranslate"><span class="pre">M_f</span></code> containing an error flag
    corresponding to the interval in the same position in
    <code class="docutils literal notranslate"><span class="pre">infodict['rslist']</span></code>.  See the explanation dictionary (last entry
    in the output tuple) for the meaning of the codes.


<strong>Details of QUADPACK level routines</strong>

<cite>quad</cite> calls routines from the FORTRAN library QUADPACK. This section
provides details on the conditions for each routine to be called and a
short description of each routine. The routine called depends on
<cite>weight</cite>, <cite>points</cite> and the integration limits <cite>a</cite> and <cite>b</cite>.

================  ==============  ==========  =====================
QUADPACK routine  <cite>weight</cite>        <cite>points</cite>    infinite bounds
================  ==============  ==========  =====================
qagse             None            No          No
qagie             None            No          Yes
qagpe             None            Yes         No
qawoe             'sin', 'cos'    No          No
qawfe             'sin', 'cos'    No          either <cite>a</cite> or <cite>b</cite>
qawse             'alg*'          No          No
qawce             'cauchy'        No          No
================  ==============  ==========  =====================

The following provides a short desciption from <a href="#id7"><span class="problematic" id="id4">[1]_</span></a> for each
routine.

qagse
    is an integrator based on globally adaptive interval
    subdivision in connection with extrapolation, which will
    eliminate the effects of integrand singularities of
    several types.
qagie
    handles integration over infinite intervals. The infinite range is
    mapped onto a finite interval and subsequently the same strategy as
    in <code class="docutils literal notranslate"><span class="pre">QAGS</span></code> is applied.
qagpe
    serves the same purposes as QAGS, but also allows the
    user to provide explicit information about the location
    and type of trouble-spots i.e. the abscissae of internal
    singularities, discontinuities and other difficulties of
    the integrand function.
qawoe
    is an integrator for the evaluation of
    <span class="math notranslate nohighlight">\(\int^b_a \cos(\omega x)f(x)dx\)</span> or
    <span class="math notranslate nohighlight">\(\int^b_a \sin(\omega x)f(x)dx\)</span>
    over a finite interval [a,b], where <span class="math notranslate nohighlight">\(\omega\)</span> and <span class="math notranslate nohighlight">\(f\)</span>
    are specified by the user. The rule evaluation component is based
    on the modified Clenshaw-Curtis technique

    An adaptive subdivision scheme is used in connection
    with an extrapolation procedure, which is a modification
    of that in <code class="docutils literal notranslate"><span class="pre">QAGS</span></code> and allows the algorithm to deal with
    singularities in <span class="math notranslate nohighlight">\(f(x)\)</span>.
qawfe
    calculates the Fourier transform
    <span class="math notranslate nohighlight">\(\int^\infty_a \cos(\omega x)f(x)dx\)</span> or
    <span class="math notranslate nohighlight">\(\int^\infty_a \sin(\omega x)f(x)dx\)</span>
    for user-provided <span class="math notranslate nohighlight">\(\omega\)</span> and <span class="math notranslate nohighlight">\(f\)</span>. The procedure of
    <code class="docutils literal notranslate"><span class="pre">QAWO</span></code> is applied on successive finite intervals, and convergence
    acceleration by means of the <span class="math notranslate nohighlight">\(\varepsilon\)</span>-algorithm is applied
    to the series of integral approximations.
qawse
    approximate <span class="math notranslate nohighlight">\(\int^b_a w(x)f(x)dx\)</span>, with <span class="math notranslate nohighlight">\(a &lt; b\)</span> where
    <span class="math notranslate nohighlight">\(w(x) = (x-a)^{\alpha}(b-x)^{\beta}v(x)\)</span> with
    <span class="math notranslate nohighlight">\(\alpha,\beta &gt; -1\)</span>, where <span class="math notranslate nohighlight">\(v(x)\)</span> may be one of the
    following functions: <span class="math notranslate nohighlight">\(1\)</span>, <span class="math notranslate nohighlight">\(\log(x-a)\)</span>, <span class="math notranslate nohighlight">\(\log(b-x)\)</span>,
    <span class="math notranslate nohighlight">\(\log(x-a)\log(b-x)\)</span>.

    The user specifies <span class="math notranslate nohighlight">\(\alpha\)</span>, <span class="math notranslate nohighlight">\(\beta\)</span> and the type of the
    function <span class="math notranslate nohighlight">\(v\)</span>. A globally adaptive subdivision strategy is
    applied, with modified Clenshaw-Curtis integration on those
    subintervals which contain <cite>a</cite> or <cite>b</cite>.
qawce
    compute <span class="math notranslate nohighlight">\(\int^b_a f(x) / (x-c)dx\)</span> where the integral must be
    interpreted as a Cauchy principal value integral, for user specified
    <span class="math notranslate nohighlight">\(c\)</span> and <span class="math notranslate nohighlight">\(f\)</span>. The strategy is globally adaptive. Modified
    Clenshaw-Curtis integration is used on those intervals containing the
    point <span class="math notranslate nohighlight">\(x = c\)</span>.

<strong>Integration of Complex Function of a Real Variable</strong>

A complex valued function, <span class="math notranslate nohighlight">\(f\)</span>, of a real variable can be written as
<span class="math notranslate nohighlight">\(f = g + ih\)</span>.  Similarly, the integral of <span class="math notranslate nohighlight">\(f\)</span> can be
written as

.. math::
    int_a^b f(x) dx = int_a^b g(x) dx + iint_a^b h(x) dx

assuming that the integrals of <span class="math notranslate nohighlight">\(g\)</span> and <span class="math notranslate nohighlight">\(h\)</span> exist
over the inteval <span class="math notranslate nohighlight">\([a,b]\)</span> <a href="#id8"><span class="problematic" id="id5">[2]_</span></a>. Therefore, <code class="docutils literal notranslate"><span class="pre">quad</span></code> integrates
complex-valued functions by integrating the real and imaginary components
separately.


References
----------

.. [1] Piessens, Robert; de Doncker-Kapenga, Elise;
       Überhuber, Christoph W.; Kahaner, David (1983).
       QUADPACK: A subroutine package for automatic integration.
       Springer-Verlag.
       ISBN 978-3-540-12553-2.

.. [2] McCullough, Thomas; Phillips, Keith (1973).
       Foundations of Analysis in the Complex Plane.
       Holt Rinehart Winston.
       ISBN 0-03-086370-8

Examples
--------
Calculate <span class="math notranslate nohighlight">\(\int^4_0 x^2 dx\)</span> and compare with an analytic result

&gt;&gt;&gt; from scipy import integrate
&gt;&gt;&gt; import numpy as np
&gt;&gt;&gt; x2 = lambda x: x**2
&gt;&gt;&gt; integrate.quad(x2, 0, 4)
(21.333333333333332, 2.3684757858670003e-13)
&gt;&gt;&gt; print(4**3 / 3.)  # analytical result
21.3333333333

Calculate <span class="math notranslate nohighlight">\(\int^\infty_0 e^{-x} dx\)</span>

&gt;&gt;&gt; invexp = lambda x: np.exp(-x)
&gt;&gt;&gt; integrate.quad(invexp, 0, np.inf)
(1.0, 5.842605999138044e-11)

Calculate <span class="math notranslate nohighlight">\(\int^1_0 a x \,dx\)</span> for <span class="math notranslate nohighlight">\(a = 1, 3\)</span>

&gt;&gt;&gt; f = lambda x, a: a*x
&gt;&gt;&gt; y, err = integrate.quad(f, 0, 1, args=(1,))
&gt;&gt;&gt; y
0.5
&gt;&gt;&gt; y, err = integrate.quad(f, 0, 1, args=(3,))
&gt;&gt;&gt; y
1.5

Calculate <span class="math notranslate nohighlight">\(\int^1_0 x^2 + y^2 dx\)</span> with ctypes, holding
y parameter as 1::

    testlib.c =&gt;
        double func(int n, double args[n]){
            return args[0]*args[0] + args[1]*args[1];}
    compile to library testlib.*

::

   from scipy import integrate
   import ctypes
   lib = ctypes.CDLL('/home/.../testlib.*') #use absolute path
   lib.func.restype = ctypes.c_double
   lib.func.argtypes = (ctypes.c_int,ctypes.c_double)
   integrate.quad(lib.func,0,1,(1))
   #(1.3333333333333333, 1.4802973661668752e-14)
   print((1.0**3/3.0 + 1.0) - (0.0**3/3.0 + 0.0)) #Analytic result
   # 1.3333333333333333

Be aware that pulse shapes and other sharp features as compared to the
size of the integration interval may not be integrated correctly using
this method. A simplified example of this limitation is integrating a
y-axis reflected step function with many zero values within the integrals
bounds.

&gt;&gt;&gt; y = lambda x: 1 if x&lt;=0 else 0
&gt;&gt;&gt; integrate.quad(y, -1, 1)
(1.0, 1.1102230246251565e-14)
&gt;&gt;&gt; integrate.quad(y, -1, 100)
(1.0000000002199108, 1.0189464580163188e-08)
&gt;&gt;&gt; integrate.quad(y, -1, 10000)
(0.0, 0.0)</pre>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">[((</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span><span class="p">),</span> <span class="n">integrate</span><span class="o">.</span><span class="n">quad</span><span class="p">(</span><span class="n">f1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">xmax</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span> <span class="k">for</span> <span class="n">xmax</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">)]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="mf">0.34858491873298725</span><span class="p">),</span>
 <span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="mf">0.8600106383901718</span><span class="p">),</span>
 <span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="mf">1.0438816972950689</span><span class="p">),</span>
 <span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="mf">1.0074874684274517</span><span class="p">)]</span>
</pre></div>
</div>
<p>La rutina devuelve dos valores. El primero es la estimación del valor de
la integral y el segundo una estimación del <strong>error absoluto</strong> . Además,
la función acepta límites de integración infinitos (<span class="math notranslate nohighlight">\(\pm \infty\)</span>,
definidos en <strong>Numpy</strong>)</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">integrate</span><span class="o">.</span><span class="n">quad</span><span class="p">(</span><span class="n">f1</span><span class="p">,</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="o">-</span><span class="mf">0.3871487639489655</span><span class="p">,</span> <span class="mf">5.459954790979472e-09</span><span class="p">)</span>
</pre></div>
</div>
<section id="ejemplo-de-funcion-fuertemente-oscilatoria">
<h3>Ejemplo de función fuertemente oscilatoria<a class="headerlink" href="#ejemplo-de-funcion-fuertemente-oscilatoria" title="Enlace permanente a este encabezado"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">k</span> <span class="o">=</span> <span class="mi">200</span>
<span class="n">L</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span>
<span class="n">a</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="k">def</span> <span class="nf">f2</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
  <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">k</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">a</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Valor exacto de la integral</span>
<span class="n">I</span><span class="o">=</span><span class="n">k</span><span class="o">/</span><span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">a</span><span class="o">*</span><span class="n">L</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">k</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">0.0023325601276845158</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Iq</span><span class="o">=</span> <span class="n">integrate</span><span class="o">.</span><span class="n">quad</span><span class="p">(</span><span class="n">f2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">L</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">ipykernel_10283</span><span class="o">/</span><span class="mf">604810385.</span><span class="n">py</span><span class="p">:</span><span class="mi">1</span><span class="p">:</span> <span class="n">IntegrationWarning</span><span class="p">:</span> <span class="n">The</span> <span class="n">maximum</span> <span class="n">number</span> <span class="n">of</span> <span class="n">subdivisions</span> <span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="n">has</span> <span class="n">been</span> <span class="n">achieved</span><span class="o">.</span>
  <span class="n">If</span> <span class="n">increasing</span> <span class="n">the</span> <span class="n">limit</span> <span class="n">yields</span> <span class="n">no</span> <span class="n">improvement</span> <span class="n">it</span> <span class="ow">is</span> <span class="n">advised</span> <span class="n">to</span> <span class="n">analyze</span>
  <span class="n">the</span> <span class="n">integrand</span> <span class="ow">in</span> <span class="n">order</span> <span class="n">to</span> <span class="n">determine</span> <span class="n">the</span> <span class="n">difficulties</span><span class="o">.</span>  <span class="n">If</span> <span class="n">the</span> <span class="n">position</span> <span class="n">of</span> <span class="n">a</span>
  <span class="n">local</span> <span class="n">difficulty</span> <span class="n">can</span> <span class="n">be</span> <span class="n">determined</span> <span class="p">(</span><span class="n">singularity</span><span class="p">,</span> <span class="n">discontinuity</span><span class="p">)</span> <span class="n">one</span> <span class="n">will</span>
  <span class="n">probably</span> <span class="n">gain</span> <span class="kn">from</span> <span class="nn">splitting</span> <span class="n">up</span> <span class="n">the</span> <span class="n">interval</span> <span class="ow">and</span> <span class="n">calling</span> <span class="n">the</span> <span class="n">integrator</span>
  <span class="n">on</span> <span class="n">the</span> <span class="n">subranges</span><span class="o">.</span>  <span class="n">Perhaps</span> <span class="n">a</span> <span class="n">special</span><span class="o">-</span><span class="n">purpose</span> <span class="n">integrator</span> <span class="n">should</span> <span class="n">be</span> <span class="n">used</span><span class="o">.</span>
  <span class="n">Iq</span><span class="o">=</span> <span class="n">integrate</span><span class="o">.</span><span class="n">quad</span><span class="p">(</span><span class="n">f2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">L</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">I_err</span> <span class="o">=</span> <span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="n">Iq</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="n">I</span>             <span class="c1"># Error relativo con el valor exacto</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;I= </span><span class="si">{:.5g}</span><span class="s2"> ± </span><span class="si">{:.5g}</span><span class="se">\n</span><span class="s2">Error relativo= </span><span class="si">{:.6g}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="n">Iq</span><span class="p">,</span> <span class="n">I_err</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>I= -0.0043611 ± 0.019119
Error relativo= 2.86965
</pre></div>
</div>
<p>El error relativo entre el valor obtenido numéricamente y el valor
exacto <code class="docutils literal notranslate"><span class="pre">I</span></code> es grande. Esto se debe a la naturaleza del integrando.
Grafiquemos sólo una pequeña parte</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">L</span><span class="p">,</span><span class="mi">1500</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f2</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="o">&lt;</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">lines</span><span class="o">.</span><span class="n">Line2D</span> <span class="n">at</span> <span class="mh">0x7f7742bed350</span><span class="o">&gt;</span><span class="p">]</span>
</pre></div>
</div>
<img alt="_images/12_1_intro_scipy_47_1.png" src="_images/12_1_intro_scipy_47_1.png" />
<p>La rutina <code class="docutils literal notranslate"><span class="pre">quad</span></code> es versatil y tiene una opción específica para
integrandos oscilatorios, que permite calcular las integrales de una
función <span class="math notranslate nohighlight">\(f\)</span> multiplicadas por una función oscilatoria</p>
<div class="math notranslate nohighlight">
\[I= \int_{a}^{b} f(x)\,weight( w x)\, dx\]</div>
<p>Para ello debemos usar el argumento <code class="docutils literal notranslate"><span class="pre">weight</span></code> y <code class="docutils literal notranslate"><span class="pre">wvar</span></code>. En este caso
usaremos <code class="docutils literal notranslate"><span class="pre">weight='sin'</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># La función sin el factor oscilatorio:</span>
<span class="k">def</span> <span class="nf">f3</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
  <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">a</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Is</span><span class="o">=</span> <span class="n">integrate</span><span class="o">.</span><span class="n">quad</span><span class="p">(</span><span class="n">f3</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">L</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;sin&#39;</span><span class="p">,</span> <span class="n">wvar</span><span class="o">=</span><span class="n">k</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">I_err</span> <span class="o">=</span> <span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="n">Is</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="n">I</span>             <span class="c1"># Error relativo con el valor exacto</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;I= </span><span class="si">{:.5g}</span><span class="s2"> ± </span><span class="si">{:.5g}</span><span class="se">\n</span><span class="s2">Error relativo= </span><span class="si">{:.6g}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="n">Is</span><span class="p">,</span> <span class="n">I_err</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>I= 0.0023326 ± 3.4061e-19
Error relativo= 5e-07
</pre></div>
</div>
<p>Esto es así, porque una vez que separamos el comportamiento oscilatorio,
la función es suave y fácilmente integrable</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f3</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="o">&lt;</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">lines</span><span class="o">.</span><span class="n">Line2D</span> <span class="n">at</span> <span class="mh">0x7f774216d410</span><span class="o">&gt;</span><span class="p">]</span>
</pre></div>
</div>
<img alt="_images/12_1_intro_scipy_53_1.png" src="_images/12_1_intro_scipy_53_1.png" />
<p>El error relativo obtenido respecto al valor exacto es varios órdenes de
magnitud menor. Comparemos los tiempos de ejecución:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="n">timeit</span> <span class="n">integrate</span><span class="o">.</span><span class="n">quad</span><span class="p">(</span><span class="n">f2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">L</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">magic</span><span class="o">-</span><span class="n">timeit</span><span class="o">&gt;</span><span class="p">:</span><span class="mi">1</span><span class="p">:</span> <span class="n">IntegrationWarning</span><span class="p">:</span> <span class="n">The</span> <span class="n">maximum</span> <span class="n">number</span> <span class="n">of</span> <span class="n">subdivisions</span> <span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="n">has</span> <span class="n">been</span> <span class="n">achieved</span><span class="o">.</span>
  <span class="n">If</span> <span class="n">increasing</span> <span class="n">the</span> <span class="n">limit</span> <span class="n">yields</span> <span class="n">no</span> <span class="n">improvement</span> <span class="n">it</span> <span class="ow">is</span> <span class="n">advised</span> <span class="n">to</span> <span class="n">analyze</span>
  <span class="n">the</span> <span class="n">integrand</span> <span class="ow">in</span> <span class="n">order</span> <span class="n">to</span> <span class="n">determine</span> <span class="n">the</span> <span class="n">difficulties</span><span class="o">.</span>  <span class="n">If</span> <span class="n">the</span> <span class="n">position</span> <span class="n">of</span> <span class="n">a</span>
  <span class="n">local</span> <span class="n">difficulty</span> <span class="n">can</span> <span class="n">be</span> <span class="n">determined</span> <span class="p">(</span><span class="n">singularity</span><span class="p">,</span> <span class="n">discontinuity</span><span class="p">)</span> <span class="n">one</span> <span class="n">will</span>
  <span class="n">probably</span> <span class="n">gain</span> <span class="kn">from</span> <span class="nn">splitting</span> <span class="n">up</span> <span class="n">the</span> <span class="n">interval</span> <span class="ow">and</span> <span class="n">calling</span> <span class="n">the</span> <span class="n">integrator</span>
  <span class="n">on</span> <span class="n">the</span> <span class="n">subranges</span><span class="o">.</span>  <span class="n">Perhaps</span> <span class="n">a</span> <span class="n">special</span><span class="o">-</span><span class="n">purpose</span> <span class="n">integrator</span> <span class="n">should</span> <span class="n">be</span> <span class="n">used</span><span class="o">.</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>3.55 ms ± 144 µs per loop (mean ± std. dev. of 7 runs, 100 loops each)
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="n">timeit</span> <span class="n">integrate</span><span class="o">.</span><span class="n">quad</span><span class="p">(</span><span class="n">f3</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">L</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;sin&#39;</span><span class="p">,</span> <span class="n">wvar</span><span class="o">=</span><span class="n">k</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>23.1 µs ± 642 ns per loop (mean ± std. dev. of 7 runs, 10,000 loops each)
</pre></div>
</div>
<p>Usar un integrador más específico para el integrando no sólo nos da un
mejor resultado sino que el tiempo de ejecución es más de 100 veces más
corto.</p>
</section>
<section id="funciones-de-mas-de-una-variable">
<h3>Funciones de más de una variable<a class="headerlink" href="#funciones-de-mas-de-una-variable" title="Enlace permanente a este encabezado"></a></h3>
<p>Consideremos el caso en que queremos integrar alguna función especial.
Podemos usar Scipy para realizar la integración y para evaluar el
integrando. Como <code class="docutils literal notranslate"><span class="pre">special.jn</span></code> depende de dos variables, tenemos que
crear una función intermedia que dependa sólo de la variable de
integración</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">integrate</span><span class="o">.</span><span class="n">quad</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">special</span><span class="o">.</span><span class="n">jn</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">x</span><span class="p">),</span> <span class="mi">0</span> <span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mf">1.0670113039567362</span><span class="p">,</span> <span class="mf">7.434789460651883e-14</span><span class="p">)</span>
</pre></div>
</div>
<p>En realidad, la función <code class="docutils literal notranslate"><span class="pre">quad</span></code> permite el uso de argumentos que se le
pasan a la función a integrar. La forma de llamar al integrador será en
general:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">quad</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(),</span> <span class="n">full_output</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">epsabs</span><span class="o">=</span><span class="mf">1.49e-08</span><span class="p">,</span> <span class="n">epsrel</span><span class="o">=</span><span class="mf">1.49e-08</span><span class="p">,</span>
    <span class="n">limit</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">points</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">wvar</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">wopts</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">maxp1</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
    <span class="n">limlst</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
</pre></div>
</div>
<p>El argumento <code class="docutils literal notranslate"><span class="pre">args</span></code> debe ser una tupla, y contiene los argumentos
extra que acepta la función a integrar, esta función debe llamarse en la
forma <code class="docutils literal notranslate"><span class="pre">func(x,</span> <span class="pre">*args)</span></code>. O sea que siempre la integramos respecto a su
primer argumento. Apliquemos esto a la función de Bessel. En este caso,
la variable a integrar es el segundo argumento de <code class="docutils literal notranslate"><span class="pre">special.jn</span></code>, por lo
que creamos una función con el orden correcto de argumentos:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">bessel_n</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
  <span class="k">return</span> <span class="n">special</span><span class="o">.</span><span class="n">jn</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">integrate</span><span class="o">.</span><span class="n">quad</span><span class="p">(</span><span class="n">bessel_n</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mf">1.0670113039567362</span><span class="p">,</span> <span class="mf">7.434789460651883e-14</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;n    \int_0^10  J_n(x) dx&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">):</span>
  <span class="nb">print</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="s1">&#39;: &#39;</span><span class="p">,</span> <span class="n">integrate</span><span class="o">.</span><span class="n">quad</span><span class="p">(</span><span class="n">bessel_n</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">n</span><span class="p">,))[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
<pre class="literal-block">n    int_0^10  J_n(x) dx
0 :  1.0670113039567362
1 :  1.2459357644513482
2 :  0.9800658116190144
3 :  0.7366751370811073
4 :  0.8633070530086401
5 :  1.1758805092851239</pre>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>Para calcular integrales múltiples existen rutinas que hacen llamados
sucesivos a la rutina <code class="docutils literal notranslate"><span class="pre">quad()</span></code>. Esto incluye rutinas para integrales
dobles (rutina <code class="docutils literal notranslate"><span class="pre">dblquad()</span></code>), triples (rutina <code class="docutils literal notranslate"><span class="pre">tplquad()</span></code>) y en
general n-dimensionales (rutina <code class="docutils literal notranslate"><span class="pre">nquad()</span></code>)</p>
</div>
</section>
</section>
<hr class="docutils" />
<section id="ejercicios-12-a">
<h2>Ejercicios 12 (a)<a class="headerlink" href="#ejercicios-12-a" title="Enlace permanente a este encabezado"></a></h2>
<ol class="arabic">
<li><p>Calcular (utilizando <code class="docutils literal notranslate"><span class="pre">quad</span></code>) y graficar para valores de
<span class="math notranslate nohighlight">\(k=1,2,5,10\)</span>m como función del límite superior <span class="math notranslate nohighlight">\(L\)</span>, el
valor de las integrales:</p>
<div class="math notranslate nohighlight">
\[I_{1}(k,L) = \int_{0}^{L} x^{k} e^{-k x / 2} dx\]</div>
<p>y</p>
<div class="math notranslate nohighlight">
\[I_{2}(k,L) = \int_{0}^{L} x^{k} e^{-k x / 2} \sin{(k x)} dx\]</div>
</li>
</ol>
<p>con rango de variación de <span class="math notranslate nohighlight">\(L\)</span> entre <span class="math notranslate nohighlight">\(0\)</span> y <span class="math notranslate nohighlight">\(2 \pi\)</span>.</p>
<hr class="docutils" />
<p>.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Pie de página">
        <a href="clase_11.html" class="btn btn-neutral float-left" title="Clase 11: Graficación usando Plotly" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Anterior</a>
        <a href="ejercicios.html" class="btn btn-neutral float-right" title="Ejercicios" accesskey="n" rel="next">Siguiente <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Derechos de autor IB - 2024, Juan Fiol.</p>
  </div>

  Compilado con <a href="https://www.sphinx-doc.org/">Sphinx</a> usando un
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">tema</a>
    proporcionado por <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>