.. _clase_11:


=========================
Clase 11: Visualizaci√≥n 
=========================

==============

Para graficar datos y funciones vamos a usar la biblioteca
**Matplotlib**. Vamos a empezar discutiendo algunas de las
caracter√≠sticas m√°s generales del trabajo con esta biblioteca y mostrar
alg√∫n ejemplo relativamente sencillo. Matplotlib est√° dividido en tres
partes o capas conceptualmente bien delimitadas:

-  Una parte es la que hace el trabajo m√°s b√°sico creando y
   administrando cada objeto que forma parte del gr√°fico (l√≠neas, texto,
   figuras, etc) as√≠ como sus relaciones,
-  Una segunda parte que permite un uso simple de las funciones
   anteriores: una interfaz con el usuario. Un ejemplo es el subm√≥dulo
   **pyplot**.
-  Una tercera componente que se encarga de presentar la figura en el
   formato adecuado. Esto es lo que se llama el *Backend* y se encarga
   de mostrar la figura en los distintos sistemas de ventanas, o en
   formatos de archivos correspondientes. Algunos ejemplos de *backend*
   son: PS (copias PostScript¬Æ), SVG (Scalable Vector Graphics), Agg
   (salida PNG de muy buena calidad), Cairo (png, pdf, ps, svg), GTK
   (interactivo, permite integrar matplotlib con aplicaciones Gtk+, que
   usa GNOME), PDF, WxWidgets (interactivo), Qt (interactivo).

Nosotros vamos a concentrarnos principalmente en aprender a utilizar
**pyplot**

.. code:: python

    import numpy as np
    import matplotlib.pyplot as plt
    from pathlib import Path

Interactividad
==============

Trabajo con ventanas emergentes
-------------------------------

Podemos trabajar en forma interactiva con gr√°ficos desde una terminal de
``Ipython``

.. code:: python

     import matplotlib.pyplot as plt # o equivalentemente:
     # from matplotlib import pyplot as plt
     plt.plot([0,1,4,9,16,25])

El comando (la funci√≥n) ``plot()`` crea el gr√°fico pero no lo muestra.
Lo hacemos expl√≠citamente con el comando ``show()``

.. code:: python

     plt.show()

Vemos que es muy simple graficar datos.

Algunas cosas a notar:

1. Se abre una ventana
2. Se bloquea la terminal (no podemos dar nuevos comandos)
3. Si pasamos el *mouse* sobre el gr√°fico nos muestra las coordenadas.
4. Adem√°s del gr√°fico hay una barra de herramientas: .. image:: figuras/matplotlib_toolbar.png

 De derecha
   a izquierda tenemos:

-  **Grabar:** Este bot√≥n abre una ventana para guardar el gr√°fico en
   alguno de los formatos disponibles.

-  **Configuraci√≥n de subplots:** Permite modificar el tama√±o y posici√≥n
   de cada gr√°fico en la ventana.

-  **Agrandar (zoom) a rect√°ngulo:**

   -  Si elegimos una regi√≥n mientras apretamos el bot√≥n **izquierdo**,
      esta ser√° la nueva regi√≥n visible ocupando toda la ventana.
   -  Si elegimos una regi√≥n mientras apretamos el bot√≥n **derecho**,
      pone toda la vista actual en esta regi√≥n.

-  **Desplazar y agrandar (Pan and zoom):** Este bot√≥n cumple dos
   funciones diferentes:

   -  Con el bot√≥n izquierdo desplaza la vista.
   -  Con el bot√≥n derecho la vista se agrandar√° achicar√° en los ejes
      horizontal y vertical en una cantidad proporcional al movimiento.

   Si se oprime las teclas ``x`` o ``y`` las dos funciones quedan
   restringidas al eje correspondiente.

-  **Home, Back, Forward** son botones que nos llevan a la vista
   original, una vista hacia atr√°s o hacia adelante respectivamente



Si ocurre, como en este caso, que proveemos s√≥lo una lista de datos, la
funci√≥n ``plot()`` la interpreta como los valores correspondientes al
eje vertical (eje y), y toma el √≠ndice del dato para la variable
independiente (eje x). Si queremos dar valores expl√≠citamente para el
eje x debemos pasarlos como primer argumento.

.. code:: python

   plt.plot([0,1,2,3,4,5],[0,1,4,9,16,25])
   plt.show()

Como vemos, para que muestre la ventana debemos hacer un llamado
expl√≠cito a la funci√≥n ``show()``. Esto es as√≠ porque muchas veces
queremos realizar m√°s de una operaci√≥n sobre un gr√°fico antes de
mostrarlo. Sin embargo, hay varias alternativas respecto a la
interactividad de matplotlib (e ipython) que permiten adecuarla a
nuestro flujo de trabajo. La manera m√°s com√∫n en una terminal es
utilizando las funci√≥n ``ion()`` (**i**\ nteractive **on**) para hacerlo
interactivo y la funci√≥n ``ioff()`` para no interactivo.

.. code:: python

   plt.ion()           # Prendemos el modo interactivo
   plt.plot([0,1,2,3,4,5],[0,1,4,9,16,25])

En el modo interactivo no s√≥lo ``plot()`` tiene impl√≠cito el comando
``show()`` sino que podemos seguir ingresando comandos con el gr√°fico
abierto.

Trabajo sobre notebooks
-----------------------

Para trabajar en *ipython notebooks* suele ser conveniente realizar los
gr√°ficos dentro de la misma p√°gina donde realizamos los c√°lculos

.. code:: python

    import matplotlib.pyplot as plt
    plt.plot([1,2,3,4,5,6],[0,1,4,9,16,25])




.. parsed-literal::

    [<matplotlib.lines.Line2D at 0x7fc0e86e2fd0>]




.. image:: figuras/11_1_intro_visualizacion_11_1.png


En la pr√°ctica vamos a usar siempre **Matplotlib** junto con **Numpy**.

.. code:: python

    fdatos = Path().cwd() / 'data/ej_oscil_aten_err.dat'

Gr√°ficos simples
================

El paquete *Matplotlib* permite visualizar datos guardados en un archivo
con unas pocas l√≠neas

.. code:: python

    x, y, yexp = np.loadtxt(fdatos, unpack=True)
    plt.plot(x, y)




.. parsed-literal::

    [<matplotlib.lines.Line2D at 0x7fc0e844ed50>]




.. image:: figuras/11_1_intro_visualizacion_16_1.png


Como vemos, es la curva que graficamos la clase anterior.

Si miramos el archivo vamos a ver que tiene una columna m√°s que
corresponde a los valores medidos. En consecuencia le asignamos esta
tercera columna a una variable adicional ``yexp`` al leerlo.

.. code:: python

    # Graficamos las segunda y tercera columnas como funci√≥n de la primera
    plt.plot(x,yexp, x,y)




.. parsed-literal::

    [<matplotlib.lines.Line2D at 0x7fc0e84c5310>,
     <matplotlib.lines.Line2D at 0x7fc0e84c5450>]




.. image:: figuras/11_1_intro_visualizacion_18_1.png


Formato de las curvas
=====================

En los gr√°ficos anteriores usamos la funci√≥n ``plot()`` en sus formas
m√°s simples.

.. code:: python

   plot(y)
   plot(x,y)
   plot(x1,y1, x2, y2)

dando a la funci√≥n ``plot()`` la informaci√≥n m√≠nima necesaria para
graficar los datos. Usualmente queremos poder elegir c√≥mo vamos a
graficar nuestros datos.

L√≠neas, s√≠mbolos y colores
--------------------------

La forma m√°s simple de elegir el modo de graficaci√≥n de la curva es a
trav√©s de un tercer argumento. Este argumento, que aparece
inmediatamente despu√©s de los datos (x e y), permite controlar el tipo
de l√≠nea o s√≠mbolo utilizado en la graficaci√≥n. En el caso de la l√≠nea
s√≥lida se puede especificar con un gui√≥n (‚Äò-‚Äô) o simplemente no poner
nada, ya que l√≠nea s√≥lida es el s√≠mbolo por defecto. Las dos
especificaciones anteriores son equivalentes. Tambi√©n se puede elegir el
color, o el s√≠mbolo a utilizar con este argumento:

.. code:: python

   plot(x,y,'g-')
   plot(x,y,'ro')
   plot(x,y,'r-o')

.. image:: figuras/simple_linea_simb.png



Para obtener c√≠rculos usamos una especificaci√≥n que corresponde a ‚Äòo‚Äô.
Adem√°s podemos poner en este argumento el color. En este caso elegimos
graficar en color ‚Äúrojo (r), con una l√≠nea (-) + c√≠rculos (o)‚Äù.

Con esta idea modificamos el gr√°fico anterior



.. code:: python

    plt.plot(x,y,'-', x,yexp, 'ro')




.. parsed-literal::

    [<matplotlib.lines.Line2D at 0x7fc0e855c190>,
     <matplotlib.lines.Line2D at 0x7fc0e855c2d0>]




.. image:: figuras/11_1_intro_visualizacion_21_1.png


Para graficar m√°s de una curva, en este formato simple, podemos ponerlo
todo en la misma funci√≥n ``plot()`` en la forma
``plot(x1, y1, [formato], x2, y2, [formato2])`` pero muchas veces es m√°s
legible separar los llamados a la funci√≥n, una para cada curva.

.. code:: python

    plt.plot(x,y, '-')
    plt.plot(x,yexp, 'or')




.. parsed-literal::

    [<matplotlib.lines.Line2D at 0x7fc0e85f7110>]




.. image:: figuras/11_1_intro_visualizacion_23_1.png


Al separar los llamados a la funci√≥n ``plot()`` obtenemos un c√≥digo m√°s
claro, principalmente cuando agregamos opciones de formato.

Los siguientes caracteres pueden utilizarse para controlar el s√≠mbolo de
graficaci√≥n:

+----------+-----------------------+----------+-----------------------+
| S√≠mbolo  | Descripci√≥n           | S√≠mbolo  | Descripci√≥n           |
+==========+=======================+==========+=======================+
| ‚Äò-‚Äô      | solid line style      | ‚Äò1‚Äô      | tri down marker       |
+----------+-----------------------+----------+-----------------------+
| ‚Äò‚Äì‚Äô      | dashed line style     | ‚Äò2‚Äô      | tri up marker         |
+----------+-----------------------+----------+-----------------------+
| ‚Äò-.‚Äô     | dash-dot line style   | ‚Äò3‚Äô      | tri left marker       |
+----------+-----------------------+----------+-----------------------+
| ‚Äò:‚Äô      | dotted line style     | ‚Äò4‚Äô      | tri right marker      |
+----------+-----------------------+----------+-----------------------+
| ‚Äò.‚Äô      | point marker          | ‚Äòs‚Äô      | square marker         |
+----------+-----------------------+----------+-----------------------+
| ‚Äò,‚Äô      | pixel marker          | ‚Äòp‚Äô      | pentagon marker       |
+----------+-----------------------+----------+-----------------------+
| ‚Äòo‚Äô      | circle marker         | ‚Äò\*‚Äô     | star marker           |
+----------+-----------------------+----------+-----------------------+
| ‚Äòv‚Äô      | triangle down marker  | ‚Äòh‚Äô      | hexagon1 marker       |
+----------+-----------------------+----------+-----------------------+
| ‚Äò^‚Äô      | triangle up marker    | ‚ÄòH‚Äô      | hexagon2 marker       |
+----------+-----------------------+----------+-----------------------+
| ‚Äò<‚Äô      | triangle left marker  | ‚Äò+‚Äô      | plus marker           |
+----------+-----------------------+----------+-----------------------+
| ‚Äò>‚Äô      | triangle right marker | ‚Äòx‚Äô      | x marker              |
+----------+-----------------------+----------+-----------------------+
| ‚Äò\|‚Äô     | vline marker          | ‚ÄòD‚Äô      | diamond marker        |
+----------+-----------------------+----------+-----------------------+
| ‚Äò\_‚Äô     | hline marker          | ‚Äòd‚Äô      | thin diamond marker   |
+----------+-----------------------+----------+-----------------------+

Los colores tambi√©n pueden elegirse usando los siguientes caracteres:

===== =======
Letra Color
===== =======
‚Äòb‚Äô   blue
‚Äòg‚Äô   green
‚Äòr‚Äô   red
‚Äòc‚Äô   cyan
‚Äòm‚Äô   magenta
‚Äòy‚Äô   yellow
‚Äòk‚Äô   black
‚Äòw‚Äô   white
===== =======

Por ejemplo, utilizando:

.. code:: python

   plt.plot(x, y1, 'gs', x, y2, '-k^', x, y3, '--r' )

obtenemos: .. image:: figuras/simple_varios.png





La funci√≥n ``plot()`` acepta un n√∫mero variable de argumentos. Veamos lo
que dice la documentaci√≥n

.. code:: python


   Signature: plt.plot(*args, **kwargs)
   Docstring:
   Plot y versus x as lines and/or markers.

   Call signatures::

       plot([x], y, [fmt], data=None, **kwargs)
       plot([x], y, [fmt], [x2], y2, [fmt2], ..., **kwargs)

En particular, podemos usar los argumentos *keywords* (pares
nombre-valor) para cambiar el modo en que se grafican los datos. Algunos
de los m√°s comunes son:

=============== ============================
Argumento       Valor
=============== ============================
linestyle       {‚Äò-‚Äô, ‚Äò‚Äì‚Äô, ‚Äò-.‚Äô, ‚Äò:‚Äô, ‚Äô‚Äô, ‚Ä¶}
linewidth       n√∫mero real
color           un color
marker          {‚Äòo‚Äô, ‚Äòs‚Äô, ‚Äòd‚Äô, ‚Ä¶.}
markersize      n√∫mero real
markeredgecolor color
markerfacecolor color
markevery       n√∫mero entero
=============== ============================

.. code:: python

    plt.plot(x,y,linewidth=1)
    plt.plot(x,yexp, 'o', color='red', markersize=2)




.. parsed-literal::

    [<matplotlib.lines.Line2D at 0x7fc0e834df90>]




.. image:: figuras/11_1_intro_visualizacion_27_1.png


.. code:: python

    plt.plot(x,y,linewidth=5)
    plt.plot(x,yexp, 'o', color='green', markersize=8)




.. parsed-literal::

    [<matplotlib.lines.Line2D at 0x7fc0e81e0e10>]




.. image:: figuras/11_1_intro_visualizacion_28_1.png


.. code:: python

    plt.plot(x,y,linewidth=5, linestyle='dashed')
    plt.plot(x,yexp, 'o', color='red', markersize=8, markeredgecolor='black',markevery=6)




.. parsed-literal::

    [<matplotlib.lines.Line2D at 0x7fc0e8243c50>]




.. image:: figuras/11_1_intro_visualizacion_29_1.png


--------------

Ejercicios 11 (a)
=================

1. Realizar un programa para visualizar la funci√≥n

   .. math::  f(x,n,w) = x^n |\sin(w x)| 

   El programa debe realizar el gr√°fico para :math:`w=10`, con cuatro
   curvas para :math:`n=1,2,3,4`, similar al que se muestra en la
   siguiente figura

   .. image:: figuras/ejerc_vis_f1.png



--------------






Adecuaci√≥n de los gr√°ficos
==========================

Veamos un ejemplo de un gr√°fico completo, con modificaciones para que
sea m√°s √∫til/atractivo ‚Ä¶

.. code:: python

    import numpy as np
    import matplotlib.pyplot as plt
    from pathlib import Path

.. code:: python

    fdatos = Path().cwd() / 'data/ej_oscil_aten_err.dat'
    foname = fdatos.with_name('ej_plot_osc')

.. code:: python

    print(fdatos)



.. parsed-literal::

    /home/fiol/Clases/IntPython/clases-python/clases/data/ej_oscil_aten_err.dat


.. code:: python

    print(foname)


.. parsed-literal::

    /home/fiol/Clases/IntPython/clases-python/clases/data/ej_plot_osc


.. code:: python

    x, y, yexp = np.loadtxt(fdatos, unpack=True)

.. code:: python

    plt.plot(x,1+y, '-b', label="teor√≠a")
    plt.plot(x,1+yexp, 'or', label="medici√≥n")
    plt.legend(loc="best", title="Mis datos")
    plt.xlabel('Tiempo (micro-segundos)')
    plt.ylabel("Voltaje (mV)")
    plt.title("Medici√≥n de ayer")
    plt.axvline(x=1, color='gray')
    plt.axhline(color='gray')
    plt.xlim((1.e-1,3))
    plt.xscale('log')
    plt.yscale('log')
    plt.ylim((0.6, 1.4))
    plt.savefig(foname.with_suffix('.png'))
    plt.savefig(foname.with_suffix('.pdf'))



.. image:: figuras/11_2_mas_visualizacion_6_0.png


Nombres de ejes y leyendas
--------------------------

Vamos ahora a agregar nombres a los ejes y a las curvas.

Para agregar nombres a las curvas, tenemos que agregar un ``label``, en
este caso en el mismo comando ``plot()``, y luego mostrarlo con
\`legend()

.. code:: python

    plt.plot(x,y, '-b', label="teor√≠a")
    plt.plot(x,yexp, 'or', label="medici√≥n")
    #plt.legend()
    plt.legend(loc="lower right", title="Mis datos")




.. parsed-literal::

    <matplotlib.legend.Legend at 0x7fe35adb8190>




.. image:: figuras/11_2_mas_visualizacion_8_1.png


Para agregar nombres a los ejes usamos ``xlabel`` y ``ylabel``:

.. code:: python

    plt.plot(x,yexp, 'or', label="medici√≥n")
    plt.plot(x,y, '-b', label="teor√≠a")
    plt.legend(loc="lower right", title="Mis datos")
    plt.xlabel('Tiempo (micro-segundos)')
    plt.ylabel("Voltaje (mV)");



.. image:: figuras/11_2_mas_visualizacion_10_0.png


Los t√≠tulos a la figura se pueden agregar con ``title``

Ac√° adem√°s agregamos una l√≠nea vertical y una horizontal.

.. code:: python

    plt.plot(x,y, '-b', label="teor√≠a")
    plt.plot(x,yexp, 'or', label="medici√≥n")
    plt.legend(loc="lower right", title="Mis datos")
    plt.xlabel('Tiempo (micro-segundos)')
    plt.ylabel("Voltaje (mV)")
    plt.title("Medici√≥n de ayer")
    plt.axvline(x=1, color='gray')
    plt.axhline(color='gray')




.. parsed-literal::

    <matplotlib.lines.Line2D at 0x7fe35ad06990>




.. image:: figuras/11_2_mas_visualizacion_13_1.png


L√≠mites de graficaci√≥n (vista)
------------------------------

Para cambiar los l√≠mites de graficaci√≥n se puede usar las funciones
``xlim`` para el eje horizontal y ``ylim`` para el vertical

.. code:: python

    plt.plot(x,y, '-b', label="teor√≠a")
    plt.plot(x,yexp, 'or', label="medici√≥n")
    plt.legend(loc="lower right", title="Mis datos")
    plt.xlabel('Tiempo (micro-segundos)')
    plt.ylabel("Voltaje (mV)")
    plt.title("Medici√≥n de ayer")
    plt.axvline(x=1, color='gray')
    plt.axhline(color='gray')
    plt.xlim((0,2.5))
    plt.ylim((-0.4, 0.32))




.. parsed-literal::

    (-0.4, 0.32)




.. image:: figuras/11_2_mas_visualizacion_15_1.png


Escalas
-------

Para pasar a escala logar√≠tmica usamos ``xscale`` o ``yscale``

.. code:: python

    plt.plot(x,y, '-b', label="teor√≠a")
    plt.plot(x,yexp, 'or', label="medici√≥n")
    plt.legend(loc="best", title="Mis datos")
    plt.xlabel('Tiempo (micro-segundos)')
    plt.ylabel("Voltaje (mV)")
    plt.xlim((1.e-1,3))
    plt.xscale('log')
    plt.ylim((-0.4, 0.32))




.. parsed-literal::

    (-0.4, 0.32)




.. image:: figuras/11_2_mas_visualizacion_18_1.png


L√≠neas verticales y horizontales
--------------------------------

.. code:: python

    plt.plot(x,y, '-b', label="teor√≠a")
    plt.plot(x,yexp, 'or', label="medici√≥n")
    plt.legend(loc="best", title="Mis datos")
    plt.xlabel('Tiempo (micro-segundos)')
    plt.ylabel("Voltaje (mV)")
    plt.title("Medici√≥n de ayer")
    plt.axvline(x=1, color='gray')
    plt.axhline(color='gray')
    plt.grid(which='both')
    plt.xlim((1.e-1,3))
    plt.xscale('log')
    plt.ylim((-0.4, 0.32))




.. parsed-literal::

    (-0.4, 0.32)




.. image:: figuras/11_2_mas_visualizacion_20_1.png


Inclusi√≥n de ecuaciones
-----------------------

Para incluir ecuaciones se puede utilizar la notaci√≥n de LaTeX para
parte del texto. Si utilizamos una expresi√≥n encerrada entre los
s√≠mbolos ``$``, matplotlib interpreta que est√° escrito en (un
subconjunto) de LaTeX.

**Matplotlib** tiene un procesador de s√≠mbolos interno para mostrar la
notaci√≥n en LaTeX que reconoce los elementos m√°s comunes, o puede
elegirse utilizar un procesador LaTeX externo.

.. code:: python

    plt.plot(x,y, '-b', label=r"$\frac{\sin(x^2)}{[2 + \cos (x)]^2}$")
    plt.plot(x,yexp, 'or', label="$\mathrm{Medici√≥n}$")
    plt.legend(loc="best", title="Mis datos", fontsize='x-large')
    plt.xlabel(r'Tiempo ($\mu$-segundos)', fontsize='x-large')
    plt.ylabel("Voltaje (mV)", fontsize='x-large')
    plt.title("Medici√≥n de ayer")
    plt.axvline(x=1, color='gray')
    plt.axhline(color='gray')
    plt.grid(which='both')
    plt.xlim((1.e-1,3))
    plt.xscale('log')
    plt.ylim((-0.4, 0.32))


.. parsed-literal::

    <>:2: SyntaxWarning: invalid escape sequence '\m'
    <>:2: SyntaxWarning: invalid escape sequence '\m'
    /tmp/ipykernel_6610/3688865428.py:2: SyntaxWarning: invalid escape sequence '\m'
      plt.plot(x,yexp, 'or', label="$\mathrm{Medici√≥n}$")




.. parsed-literal::

    (-0.4, 0.32)




.. image:: figuras/11_2_mas_visualizacion_22_2.png


Exportar las figuras
--------------------

Para guardar las figuras en alguno de los formatos disponibles
utilizamos la funci√≥n ``savefig()``.

.. code:: python

    plt.plot(x,y, '-b', label=r"$\frac{\sin(x^2)}{[2 + \cos (x)]^2}$")
    plt.plot(x,yexp, 'or', label=r"$\mathrm{Medici√≥n}$")
    plt.legend(loc="best", title="Mis datos", fontsize='x-large')
    plt.xlabel(r'Tiempo ($\mu$-segundos)', fontsize='x-large')
    plt.ylabel("Voltaje (mV)", fontsize='x-large')
    plt.title("Medici√≥n de ayer")
    plt.axvline(x=1, color='gray')
    plt.axhline(color='gray')
    plt.grid(which='both')
    plt.xlim((1.e-1,3))
    plt.xscale('log')
    plt.ylim((-0.4, 0.32))
    plt.savefig(foname.with_suffix('.png'))
    plt.savefig(foname.with_suffix('.pdf'))



.. image:: figuras/11_2_mas_visualizacion_24_0.png


.. code:: python

    print(foname)


.. parsed-literal::

    /home/fiol/Clases/IntPython/clases-python/clases/data/ej_plot_osc


.. code:: python

    print(foname.with_suffix('.png'))


.. parsed-literal::

    /home/fiol/Clases/IntPython/clases-python/clases/data/ej_plot_osc.png


.. code:: python

    plt.savefig?



.. parsed-literal::

    [0;31mSignature:[0m [0mplt[0m[0;34m.[0m[0msavefig[0m[0;34m([0m[0;34m*[0m[0margs[0m[0;34m,[0m [0;34m**[0m[0mkwargs[0m[0;34m)[0m [0;34m->[0m [0;34m'None'[0m[0;34m[0m[0;34m[0m[0m
    [0;31mDocstring:[0m
    Save the current figure as an image or vector graphic to a file.
    
    Call signature::
    
      savefig(fname, *, transparent=None, dpi='figure', format=None,
              metadata=None, bbox_inches=None, pad_inches=0.1,
              facecolor='auto', edgecolor='auto', backend=None,
              **kwargs
             )
    
    The available output formats depend on the backend being used.
    
    Parameters
    ----------
    fname : str or path-like or binary file-like
        A path, or a Python file-like object, or
        possibly some backend-dependent object such as
        `matplotlib.backends.backend_pdf.PdfPages`.
    
        If *format* is set, it determines the output format, and the file
        is saved as *fname*.  Note that *fname* is used verbatim, and there
        is no attempt to make the extension, if any, of *fname* match
        *format*, and no extension is appended.
    
        If *format* is not set, then the format is inferred from the
        extension of *fname*, if there is one.  If *format* is not
        set and *fname* has no extension, then the file is saved with
        :rc:`savefig.format` and the appropriate extension is appended to
        *fname*.
    
    Other Parameters
    ----------------
    transparent : bool, default: :rc:`savefig.transparent`
        If *True*, the Axes patches will all be transparent; the
        Figure patch will also be transparent unless *facecolor*
        and/or *edgecolor* are specified via kwargs.
    
        If *False* has no effect and the color of the Axes and
        Figure patches are unchanged (unless the Figure patch
        is specified via the *facecolor* and/or *edgecolor* keyword
        arguments in which case those colors are used).
    
        The transparency of these patches will be restored to their
        original values upon exit of this function.
    
        This is useful, for example, for displaying
        a plot on top of a colored background on a web page.
    
    dpi : float or 'figure', default: :rc:`savefig.dpi`
        The resolution in dots per inch.  If 'figure', use the figure's
        dpi value.
    
    format : str
        The file format, e.g. 'png', 'pdf', 'svg', ... The behavior when
        this is unset is documented under *fname*.
    
    metadata : dict, optional
        Key/value pairs to store in the image metadata. The supported keys
        and defaults depend on the image format and backend:
    
        - 'png' with Agg backend: See the parameter ``metadata`` of
          `~.FigureCanvasAgg.print_png`.
        - 'pdf' with pdf backend: See the parameter ``metadata`` of
          `~.backend_pdf.PdfPages`.
        - 'svg' with svg backend: See the parameter ``metadata`` of
          `~.FigureCanvasSVG.print_svg`.
        - 'eps' and 'ps' with PS backend: Only 'Creator' is supported.
    
        Not supported for 'pgf', 'raw', and 'rgba' as those formats do not support
        embedding metadata.
        Does not currently support 'jpg', 'tiff', or 'webp', but may include
        embedding EXIF metadata in the future.
    
    bbox_inches : str or `.Bbox`, default: :rc:`savefig.bbox`
        Bounding box in inches: only the given portion of the figure is
        saved.  If 'tight', try to figure out the tight bbox of the figure.
    
    pad_inches : float or 'layout', default: :rc:`savefig.pad_inches`
        Amount of padding in inches around the figure when bbox_inches is
        'tight'. If 'layout' use the padding from the constrained or
        compressed layout engine; ignored if one of those engines is not in
        use.
    
    facecolor : :mpltype:`color` or 'auto', default: :rc:`savefig.facecolor`
        The facecolor of the figure.  If 'auto', use the current figure
        facecolor.
    
    edgecolor : :mpltype:`color` or 'auto', default: :rc:`savefig.edgecolor`
        The edgecolor of the figure.  If 'auto', use the current figure
        edgecolor.
    
    backend : str, optional
        Use a non-default backend to render the file, e.g. to render a
        png file with the "cairo" backend rather than the default "agg",
        or a pdf file with the "pgf" backend rather than the default
        "pdf".  Note that the default backend is normally sufficient.  See
        :ref:`the-builtin-backends` for a list of valid backends for each
        file format.  Custom backends can be referenced as "module://...".
    
    orientation : {'landscape', 'portrait'}
        Currently only supported by the postscript backend.
    
    papertype : str
        One of 'letter', 'legal', 'executive', 'ledger', 'a0' through
        'a10', 'b0' through 'b10'. Only supported for postscript
        output.
    
    bbox_extra_artists : list of `~matplotlib.artist.Artist`, optional
        A list of extra artists that will be considered when the
        tight bbox is calculated.
    
    pil_kwargs : dict, optional
        Additional keyword arguments that are passed to
        `PIL.Image.Image.save` when saving the figure.
    
    Notes
    -----
    
    .. note::
    
        This is the :ref:`pyplot wrapper <pyplot_interface>` for `.Figure.savefig`.
    [0;31mFile:[0m      /usr/lib64/python3.13/site-packages/matplotlib/pyplot.py
    [0;31mType:[0m      function


Dos gr√°ficos en la misma figura
===============================

Hay varias funciones que permiten poner m√°s de un gr√°fico en la misma
figura. Veamos un ejemplo utilizando la funci√≥n ``subplots()``

.. code:: python

    # %load scripts/ejemplo_08_5.py
    #! /usr/bin/ipython3
    
    """ Script realizado durante la clase 9. Dos figuras """
    from pathlib import Path
    
    import numpy as np
    import matplotlib.pyplot as plt
    plt.ion()
    
    #fname = 'ej_oscil_aten_err'
    # Levantamos los datos
    #pardir = Path("..")
    
    #datfile = pardir / f'data/{fname}.dat'
    fname = fdatos.name
    
    x1, y1, y2 = np.loadtxt(fdatos, unpack=True)
    # Vamos a graficar s√≥lo algunos valores (uno de cada 5)
    x = x1[3:-10:5]
    y = y1[3:-10:5]
    yexp = y2[3:-10:5]
    
    # Ejemplo de barras de error que dependen del eje x
    error = 0.05 + 0.3 * np.abs(y)
    
    fig, (ax0, ax1) = plt.subplots(nrows=2, sharex=True)
    ax0.errorbar(x, yexp, yerr=error, fmt='-o')
    ax1.plot(x, 2 * (yexp - y) / (yexp + y), 'or', markersize=8)
    
    
    # L√≠mites de graficaci√≥n y t√≠tulos
    ax0.set_title('Datos con error variable')
    ax1.set_title('Error relativo')
    ax0.set_ylabel('Voltaje (mV)', fontsize='x-large')
    ax1.set_xlabel(r'Tiempo ($\mu$-seg)', fontsize='x-large')
    ax1.set_ylabel('Error relativo', fontsize='x-large')
    ax1.set_xlim((0, 3))
    
    # Guardamos el resultado
    plt.savefig(f'{fname}.png', dpi=150)




.. image:: figuras/11_2_mas_visualizacion_29_0.png


.. code:: python

    # %load scripts/ejemplo_08_5.py
    #! /usr/bin/ipython3
    
    """ Script realizado durante la clase 9. Dos figuras """
    from pathlib import Path
    
    import numpy as np
    import matplotlib.pyplot as plt
    plt.ion()
    
    fname = 'ej_oscil_aten_err'
    # Levantamos los datos
    pardir = Path("..")
    datfile = pardir / f'data/{fname}.dat'
    
    x1, y1, y2 = np.loadtxt(datfile, unpack=True)
    # Vamos a graficar s√≥lo algunos valores (uno de cada 5)
    x = x1[3:-10:5]
    y = y1[3:-10:5]
    yexp = y2[3:-10:5]
    
    # Ejemplo de barras de error que dependen del eje x
    error = 0.05 + 0.3 * np.abs(y)
    
    fig, (ax0, ax1) = plt.subplots(figsize=(10,4), nrows=1, ncols=2)
    ax0.errorbar(x, yexp, yerr=error, fmt='-o')
    ax1.plot(x, 2 * (yexp - y) / (yexp + y), 'or', markersize=8)
    
    
    # L√≠mites de graficaci√≥n y t√≠tulos
    ax0.set_title('Datos con error variable')
    ax1.set_title('Error relativo')
    ax0.set_ylabel('Voltaje (mV)', fontsize='x-large')
    ax1.set_xlabel(r'Tiempo ($\mu$-seg)', fontsize='x-large')
    ax1.set_ylabel('Error relativo', fontsize='x-large')
    ax1.set_xlim((0, 3))
    
    # Guardamos el resultado
    plt.savefig(f'{fname}_B.png', dpi=150)




.. image:: figuras/11_2_mas_visualizacion_30_0.png


En este ejemplo utilizamos un enfoque diferente al utilizado
anteriormente. Matplotlib presenta tambi√©n una interface orientada a
objetos. La funci√≥n ``subplots()`` devuelve un par ``fig, axis`` que son
dos objetos utilizados para representar la *figura* y un *eje*. Los
m√©todos de estos objetos presentan funcionalidad similar a las funciones
del m√≥dulo ``pyplot``.

--------------

Ejercicios 11 (b)
=================

2. Para la funci√≥n definida a trozos:

   .. math::


      f(x) =
      \begin{cases}
        f_{1}(x) = x^{2}/8 & - \pi < x \le \pi/2  \\
        f_{2}(x) = -0.3 x  & \pi/2 < x < \pi \\
        f_{3}(x) = -(x - 2 \pi)^{2}/6 & \pi \le x \le 5 \pi/2 \\
        f_{4}(x) = (x - 2 \pi)/5 & 5 \pi/2 < x \le 3 \pi
        \end{cases}

   realizar la siguiente figura de la manera m√°s fiel posible.

   .. image:: figuras/ejercicio_08_1.png



   **Pistas:** Buscar informaci√≥n sobre ``plt.text()``,
   ``plt.fill_between()`` y sobre ``plt.xticks`` y ``plt.yticks``.

3. Rehacer la siguiente figura:

   .. image:: figuras/ejercicio_08_2.png



--------------

.



